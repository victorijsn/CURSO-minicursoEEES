---
title: "Introdução a manipulação de dados no R"
subtitle: "VIII Encontro de Economia do Espírito Santo"
author: "Victor Nunes Toscano"
institute: "SETADES"
date: "10/11/2021"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

---
# Objetivo
Manipular as séries que serão utilizadas na apresentação dos modelos de previsão.


## Roteiro
1. Requisitos
2. Sobre a base de dados
3. Arrumando a base de dados (passo a passo)
  + Importar
  + Manipular
  + Exportar
4. Visualizando
5. Criando o objeto de série temporal (base)


---
# Requisitos
- R instalado - [LINK](https://cran.r-project.org/)
- RStudio instalado - [LINK](https://www.rstudio.com/products/rstudio/download/)

### Pacotes utilizados
```{r warning=FALSE, message=FALSE}
# install.packages("dplyr")
# install.packages("tidyr")
# install.packages("janitor")
# install.packages("lubridate")
# install.packages("ggplot2")
# install.packages("readxl")

library(dplyr) # manipulação de base de dados 
library(tidyr) # ferramenta de faxina de dados
library(janitor) # ferramenta para faxina de dados
library(lubridate) # pacote para lidar com datas
library(ggplot2) # pacote de visualização
library(readxl) # pacote para importar dados do Excel
```


---
# A base de dados

Nossa fonte de dados é o arquivo compilado pelo [Instituto Jones dos Santos Neves](http://ijsn.es.gov.br/) (IJSN) sobre o desempenho do setor de Serviços. A fonte principal é a Pesquisa Mensal de Serviços (PMS) publicada pelo [Instituto Brasileiro de Geografia e Estatística](https://sidra.ibge.gov.br/pesquisa/pms/tabelas) (IBGE).

Faça o download da base de dados [aqui](http://ijsn.es.gov.br/component/attachments/download/7576).

---
# A base de dados 

A **Pesquisa Mensal de Serviços** - PMS tem como objetivo produzir indicadores que permitam acompanhar o comportamento conjuntural dos principais segmentos empresariais não-financeiros do setor de serviços, excluindo-se os da saúde e da educação, complementando, através da análise de curto prazo, o mapeamento da estrutura das atividades de serviços no País, efetuado pela Pesquisa Anual de Serviços - PAS. Assim, a uma pesquisa de caráter anual e estrutural, vem se juntar outra de caráter conjuntural, imprescindível para o estudo das variações cíclicas do setor de serviços.

## Importando
Vamos olhar para a base de dados primeiro.

```{r}
dados <- readxl::read_xlsx("./bases/07_2021_PMS-78.xlsx", sheet = "Tabela 6442", skip = 2)
dados <- janitor::clean_names(dados) # para padronizar os nomes de variáveis
```


---
# A base de dados
## Resultado
```{r}
glimpse(dados) #comando para ver a estrutura da base de dados
```

---
# A base de dados
## Arrumando a base de dados
Para arrumarmos a base de dados os dados as linhas devem representar um período de tempo, ao passo em que as colunas representam os valores da variável ao longo do tempo. A base de dados não está estruturada dessa maneira. Por isso, vamos aplicar uma sequência de comandos para gerar uma base de dados "arrumada" para nossa análise.

Vamos focar nossa análise nas séries em nível (número índice) do Brasil e Espírito Santo, pois delas, podemos gerar diversas transformações posteriormente. Os comandos a seguir são cumulativos para gerar nossa base de dados. Copie e cole o comando em um script dentro do Rstudio.

```{r}
dados_tidy <- dados %>%
  fill(mes, unidade_territorial) %>%
  select(mes, unidade_territorial, variavel,
         indice_base_fixa_2014_100_numero_indice,
         indice_base_fixa_com_ajuste_sazonal_2014_100_numero_indice)
```




---
# A base de dados
## Arrumando a base de dados


---
# A base de dados
## Arrumando a base de dados


---
# A base de dados
## Arrumando a base de dados


---
# A base de dados
## Visualizando


---
# Objeto de série temporal


---

class: center, middle

# Obrigado!

Slides criados pelo pacote R [**xaringan**](https://github.com/yihui/xaringan).
